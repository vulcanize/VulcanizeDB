dist: trusty
language: go
go:
  - 1.11
services:
  - postgresql
addons:
  postgresql: "9.6"

go_import_path: github.com/vulcanize/vulcanizedb

before_install:
  # ginkgo golint dep goose
  - make installtools
  - bash ./scripts/install-postgres-10.sh
  - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
  - echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
  - sudo apt-get update && sudo apt-get install yarn

before_script:
  - sudo -u postgres createdb vulcanize_private
  - make migrate NAME=vulcanize_private
  - cd postgraphile && yarn

script:
  - yarn test
  - cd ../
  - make test
  - make integrationtest

notifications:
  email: false
